<!-- sldsValidatorIgnore -->
<template>
    <template if:true={isModalOpen}>
        <!-- Modal/Popup Box LWC starts here -->
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
            aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">


            <div class="slds-modal__container custom_modal">
                <!-- Modal/Popup Box LWC header here -->
                <header class="slds-modal__header">
                    <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                        title="Close" onclick={closeModal}>
                        <lightning-icon icon-name="utility:close" alternative-text="close" variant="inverse"
                            size="small" label="adlfjsl"></lightning-icon>
                        <span class="slds-assistive-text">Close</span>
                    </button>
                    <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Budget Increase</h2>
                </header>
                <!-- Modal/Popup Box LWC body starts here -->
                <div class="slds-modal__content slds-var-p-around_medium" id="modal-content-id-1">
                    <div class="slds-grid details-div">
                        <div class="slds-col phase-detail">
                            <template if:true={phaseDetails}>
                                <div class="table-container">
                                    <span class="details-heading">Phase Details</span>
                                    <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                        <tbody style="font-size: medium;">
                                            <tr>
                                                <td scope="col">
                                                    <span>Phase :</span>
                                                </td>
                                                <td scope="col">
                                                    <span>{phaseDetails.Name}</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td scope="col">
                                                    <span>Estimated Hours :</span>
                                                </td>
                                                <td scope="col">
                                                    <span>{phaseDetails.ChikPeaSSB__Estimated_Hours__c}</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td scope="col">
                                                    <span>Elapsed Hours :</span>
                                                </td>
                                                <td scope="col">
                                                    <span>{phaseDetails.ChikPeaSSB__Act_hours__c}</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td scope="col">
                                                    <span>Elapsed Value :</span>
                                                </td>
                                                <td scope="col">
                                                    <span>{phaseDetails.ChikPeaSSB__Actual_Rate__c}</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>

                                    <!-- Estimated Hours: {phaseDetails.ChikPeaSSB__Estimated_Hours__c}
                                Estimated Rate: {phaseDetails.ChikPeaSSB__Estimated_Rate__c}
                                Elapsed Hours: {phaseDetails.ChikPeaSSB__Act_hours__c}
                                Elapsed Value: {phaseDetails.ChikPeaSSB__Actual_Rate__c} -->
                                </div>
                            </template>
                        </div>
                        <div class="slds-col phase-detail">
                            <template if:true={phaseDetails}>
                                <div class="table-container">
                                    <span class="details-heading">Budget Estimates</span>
                                    <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                        <tbody style="font-size: medium;">
                                            <tr>
                                                <td scope="col">
                                                    <span>Estimated Hours :</span>
                                                </td>
                                                <td scope="col">
                                                    <span>{estimatedHour}</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td scope="col">
                                                    <span>Estimated Rate :</span>
                                                </td>
                                                <td scope="col">
                                                    <span>{estimatedRate}</span>
                                                </td>
                                            </tr>

                                        </tbody>
                                    </table>

                                    <!-- Estimated Hours: {phaseDetails.ChikPeaSSB__Estimated_Hours__c}
                                Estimated Rate: {phaseDetails.ChikPeaSSB__Estimated_Rate__c}
                                Elapsed Hours: {phaseDetails.ChikPeaSSB__Act_hours__c}
                                Elapsed Value: {phaseDetails.ChikPeaSSB__Actual_Rate__c} -->
                                </div>
                            </template>
                        </div>
                    </div>
                    <div class="resource-details">
                        <span class="details-heading">Resource Details</span>

                        <div class="table-container">
                            <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                <thead>
                                    <tr class="slds-line-height_reset">
                                        <!-- <th if:true={editData}></th> -->

                                        <th class="" scope="col">
                                            <div class="slds-truncate slds-line-clamp" style="display: flex;"
                                                title="Name">
                                                Resource
                                                <!-- <span if:true={key.isRequired} style="color: red;">*</span>
                                                <div class="sortIconContainer">
                                                    <lightning-icon class={key.upIconClass} icon-name="utility:up"
                                                        variant="success" alternative-text="up" size="xx-small"
                                                        data-type="ALL" title="Sort asending" data-id={key.fieldName}
                                                        onclick={sortAsending}>
                                                    </lightning-icon>
                                                    <lightning-icon class={key.downIconClass} icon-name="utility:down"
                                                        variant="success" alternative-text="down" size="xx-small"
                                                        data-type="ALL" title="Sort decending" data-id={key.fieldName}
                                                        onclick={sortDecending}>
                                                    </lightning-icon>
                                                </div> -->
                                            </div>

                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate slds-line-clamp" style="display: flex;"
                                                title="Name">
                                                Est
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate slds-line-clamp" style="display: flex;"
                                                title="Name">
                                                Act
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate slds-line-clamp" style="display: flex;"
                                                title="Name">
                                                Bill
                                            </div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate slds-line-clamp" style="display: flex;"
                                                title="Name">
                                                Rate
                                            </div>
                                        </th>

                                        <th class="" scope="col">
                                            <div class="slds-truncate slds-line-clamp" style="display: flex;"
                                                title="Name">
                                                Add hour
                                            </div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <template if:true={resourceDetails.length} for:each={resourceDetails}
                                        for:item="row">

                                        <tr key={row.Id}>

                                            <th scope="col" style="font-size: small;">
                                                <div class="nonEditableCell">{row.ChikPeaSSB__Item__r.Name}</div>
                                            </th>
                                            <th scope="col" style="font-size: small;">
                                                <div class="nonEditableCell">
                                                    {row.ChikPeaSSB__Estimated_Hours__c}</div>
                                            </th>
                                            <th scope="col" style="font-size: small;">
                                                <div class="nonEditableCell">{row.ChikPeaSSB__Actual_Accrued__c}</div>
                                            </th>
                                            <th scope="col" style="font-size: small;">
                                                <div class="nonEditableCell">{row.ChikPeaSSB__Billable_Accrued__c}</div>
                                            </th>
                                            <th scope="col" style="font-size: small;">
                                                <div class="nonEditableCell">{row.ChikPeaSSB__Rate__c}</div>
                                            </th>
                                            <th scope="col" style="font-size: small;">
                                                <div style="width: 100px; font-size: small;">
                                                    <lightning-input type="text" data-id={row.Id} label="None"
                                                        value={row.addedHour} variant="label-hidden"
                                                        onchange={handleAddChange}>
                                                    </lightning-input>

                                                </div>
                                            </th>
                                        </tr>

                                    </template>
                                    <template if:true={newAddedResource.length} for:each={newAddedResource}
                                        for:item="row">
                                        <!-- <tr>
                                            <td colspan="6">

                                            </td>
                                        </tr> -->
                                        <tr key={row.Id}>

                                            <th scope="col" style="font-size: small;">
                                                <div class="nonEditableCell">{row.Resource}</div>
                                            </th>
                                            <th scope="col" style="font-size: small;">
                                                <div class="nonEditableCell">
                                                    {row.EstHrs}</div>
                                            </th>
                                            <th scope="col" style="font-size: small;">
                                                <div class="nonEditableCell">0</div>
                                            </th>
                                            <th scope="col" style="font-size: small;">
                                                <div class="nonEditableCell">0</div>
                                            </th>
                                            <th scope="col" style="font-size: small;">
                                                <div class="nonEditableCell">{row.Rate}</div>
                                            </th>
                                            
                                        </tr>

                                    </template>
                                    <tr>
                                        <th>
                                            <lightning-icon icon-name="utility:new" variant="success"
                                                style="cursor: pointer;" alternative-text="Add" size="small"
                                                title="Add new resource" onclick={addNewResource}>
                                            </lightning-icon>
                                        </th>
                                    </tr>
                                </tbody>

                            </table>
                        </div>
                    </div>
                    <div class="new-resource">
                        <template if:true={showNewResource}>
                            <c-add-resource-l-w-c phase-id={phaseId} onaddnewresource={handleNewResourceAdd}>
                            </c-add-resource-l-w-c>
                        </template>
                    </div>
                    <div class="resource-details" style="margin-top:2rem">
                        <span class="details-heading">Reason for Increament</span>

                        <div style="margin-bottom: 4rem;" class="table-container">
                            <lightning-textarea name="input6" required placeholder="Provide the reason here" label="Reason" variant="label-hidden"  
                            value={reasonForIncrement} onchange={handleReasonForIncrementChange}
                            ></lightning-textarea>
                        </div>
                    </div>
                    <!-- <div class="slds-var-p-bottom_large slds-var-p-left_large" style="width:500px">
                        <lightning-record-edit-form object-api-name="ChikPeaSSB__Budget_Line__c"
                            onsuccess={handleSuccess}>
                            <lightning-messages></lightning-messages>
                            <lightning-input-field field-name="Name"> </lightning-input-field>
                            <lightning-input-field field-name="ChikPeaSSB__Description__c"> </lightning-input-field>
                            <lightning-input-field field-name="ChikPeaSSB__Est_Hours__c"> </lightning-input-field>
                            <button class="slds-button slds-button_brand" type="submit" onclick={submitDetails}
                                title="OK">OK</button>
                        </lightning-record-edit-form>
                    </div> -->
                </div>
                <!-- Modal/Popup Box LWC footer starts here -->
                <footer class="slds-modal__footer">
                    <button class="slds-button slds-button_neutral" onclick={closeModal} title="Cancel">Cancel</button>
                    <button class="slds-button slds-button_brand" type="submit" onclick={submitResource}
                        title="Add Resource">Add Resource</button>
                    <button class="slds-button slds-button_brand" type="submit" onclick={submitHours}
                        title="Add Hours">Add Hours</button>    
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>
</template>